<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EarnQuick_Official</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <script type="text/javascript">
        atOptions_adsterra = {
            'key' : '00605022df81b880d400151bfc7c2185',
            'format' : 'iframe',
            'height' : 90,
            'width' : 728,
            'params' : {}
        };
    </script>
    
    <style>
        :root {
            --primary-blue: #234d7d; --green-earn: #4CAF50; --orange-withdraw: #FF9800;
            --secondary-bg: #f5f5f5; --text-color: #333;
        }
        body { font-family: 'Arial', sans-serif; background-color: var(--secondary-bg); color: var(--text-color); margin: 0; padding: 0; touch-action: manipulation; }
        .container { padding: 0; max-width: 600px; margin: auto; background-color: white; min-height: 100vh; }
        .balance-card { background-color: var(--primary-blue); color: white; padding: 20px; text-align: center; border-radius: 0 0 15px 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); margin-bottom: 20px; }
        .balance-card span { display: block; font-size: 48px; font-weight: bold; margin: 5px 0 10px 0; }
        #ad-button, #withdraw-button { border: none; padding: 15px 20px; font-size: 16px; font-weight: bold; border-radius: 8px; cursor: pointer; width: 90%; margin: 10px 5%; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }
        #ad-button { background-color: var(--green-earn); color: white; }
        #withdraw-button { background-color: var(--orange-withdraw); color: white; }
        #ad-button:disabled { background-color: #ccc; cursor: not-allowed; }
        .menu-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 20px 10px; border-top: 1px solid #eee; margin-top: 20px; }
        .menu-btn-container { text-align: center; }
        .menu-btn { background: none; border: none; color: var(--primary-blue); font-size: 14px; cursor: pointer; display: block; width: 100%; padding: 5px 0; }
        .menu-icon { font-size: 24px; margin-bottom: 5px; display: block; }
        .ad-container { text-align: center; background-color: #fff; overflow: hidden; margin-bottom: 10px; }
        #status-message { text-align: center; padding: 10px; color: var(--primary-blue); font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <div class="balance-card">
            <h3>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶ü ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ (EarnQuick Points)</h3>
            <span id="user-points">0</span>
            <p class="note">‡ß≥‡ßß‡ß¶‡ß¶‡ß¶ ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü = ‡ß®‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ</p>
        </div>
        
        <div class="ad-container">
            <script type="text/javascript" src="//enabledetective.com/00605022df81b880d400151bfc7c2185/invoke.js"></script>
        </div>

        <button id="ad-button" disabled>‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡ßß‡ß¶ ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        <button id="withdraw-button" onclick="openWithdrawal()">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® (Withdraw)</button>
        <p id="status-message">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>

        <div class="menu-grid">
            <div class="menu-btn-container" onclick="openReferral()"><span class="menu-icon">üîó</span><button class="menu-btn">‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</button></div>
            <div class="menu-btn-container" onclick="openHistory()"><span class="menu-icon">üßæ</span><button class="menu-btn">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ø</button></div>
            <div class="menu-btn-container"><span class="menu-icon">üìû</span><button class="menu-btn" onclick="openSupport()">‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü</button></div>
        </div>
        
        <div class="ad-container" style="margin-top: 20px;">
            <script type="text/javascript" src="//enabledetective.com/00605022df81b880d400151bfc7c2185/invoke.js"></script>
        </div>
    </div>
    
    <script>
        const SERVER_URL = 'https://smartearnbdbot.onrender.com';
        const BOT_USERNAME = "@EarnQuick_Official_bot";
        const POINTS_PER_AD = 10;
        const REFERRAL_POINTS = 250; 
        const MIN_WITHDRAW = 1000;

        let telegramUserId = null;
        let currentPoints = 0;

        // --- ‡¶á‡¶â‡¶ü‡¶ø‡¶≤‡¶ø‡¶ü‡¶ø ‡¶ì API ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (Server-Client Communication) ---
        function loadTelegramUser() {
            try {
                const user = Telegram.WebApp.initDataUnsafe.user;
                if (user && user.id) {
                    telegramUserId = user.id.toString();
                    return true;
                }
                document.getElementById('status-message').innerText = "‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶ñ‡ßÅ‡¶≤‡ßÅ‡¶®‡•§";
                return false;
            } catch (e) {
                document.getElementById('status-message').innerText = "‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ SDK ‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§";
                return false;
            }
        }
        function updateUI() { document.getElementById('user-points').innerText = currentPoints.toLocaleString(); }
        
        async function fetchUserData() {
             document.getElementById('status-message').innerText = "‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
             try {
                 const response = await fetch(`${SERVER_URL}/api/user/${telegramUserId}`);
                 const data = await response.json();
                 if (response.ok) {
                     currentPoints = data.earned_points;
                     updateUI();
                     document.getElementById('status-message').innerText = "‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ!";
                     document.getElementById('ad-button').disabled = false;
                 } else {
                     document.getElementById('status-message').innerText = "‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•‡•§";
                 }
             } catch (error) {
                 document.getElementById('status-message').innerText = "‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶¨‡¶ø‡¶ö‡ßç‡¶õ‡¶ø‡¶®‡ßç‡¶®‡•§";
             }
        }

        async function addPointsToUser(pointsToAdd) {
             if (!telegramUserId) return;
             document.getElementById('status-message').innerText = "‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
             document.getElementById('ad-button').disabled = true;
             
             try {
                const response = await fetch(`${SERVER_URL}/api/add_points`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ userId: telegramUserId, points: pointsToAdd })
                });
                const data = await response.json();

                if (data.success) {
                    currentPoints = data.new_points;
                    updateUI();
                    document.getElementById('status-message').innerText = `${pointsToAdd} ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá! ‡¶Æ‡ßã‡¶ü: ${currentPoints.toLocaleString()}`;
                } else {
                    document.getElementById('status-message').innerText = "‡¶®‡ßá‡¶ü‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶ï ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡•§ ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§";
                    Telegram.WebApp.showAlert("‡¶®‡ßá‡¶ü‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶ï ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡•§ ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§");
                }
             } catch (error) {
                document.getElementById('status-message').innerText = "‡¶®‡ßá‡¶ü‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶ï ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡•§ ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§";
                Telegram.WebApp.showAlert("‡¶®‡ßá‡¶ü‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶ï ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡•§ ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§");
             } finally {
                setTimeout(() => { document.getElementById('ad-button').disabled = false; }, 5000); 
             }
        }

        // --- ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶ì ‡¶Æ‡ßá‡¶®‡ßÅ ‡¶≤‡¶ú‡¶ø‡¶ï ---
        function onAdRewardSuccess() { addPointsToUser(POINTS_PER_AD); }

        function handleAdButtonClick() {
            document.getElementById('status-message').innerText = "‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá, ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...";
            document.getElementById('ad-button').disabled = true;

            // üõë Monetag Rewarded Interstitial ‡¶ï‡ßã‡¶° ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¨‡¶∏‡¶æ‡¶® üõë
            // show_10070523().then(onAdRewardSuccess).catch((error) => { /* error handling */ });

            // ‚ö†Ô∏è ‡¶Ü‡¶™‡¶æ‡¶§‡¶§ ‡¶°‡ßá‡¶Æ‡ßã ‡¶ï‡ßã‡¶°:
             setTimeout(() => { onAdRewardSuccess(); }, 3000); 
        }
        
        function openWithdrawal() {
            if (currentPoints < MIN_WITHDRAW) {
                Telegram.WebApp.showAlert(`‡¶¶‡ßÅ‡¶É‡¶ñ‡¶ø‡¶§! ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡¶∞‡ßç‡¶¨‡¶®‡¶ø‡¶Æ‡ßç‡¶® ${MIN_WITHDRAW} ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü (‡ß≥‡ß®‡ß¶) ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡•§ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü: ${currentPoints.toLocaleString()}`);
                return;
            }
            Telegram.WebApp.showAlert(`‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶® ‡¶Ö‡¶™‡¶∂‡¶® ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...`);
        }

        function openReferral() {
            if (!telegramUserId) return;
            const referralLink = `https://t.me/${BOT_USERNAME}?start=${telegramUserId}`;
            const message = `üéâ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶≤‡¶ø‡¶Ç‡¶ï:\n\nüîó ${referralLink}\n\nüî• ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∏‡¶´‡¶≤ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶™‡¶æ‡¶¨‡ßá‡¶®: ${REFERRAL_POINTS} ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü‡•§`;
            
            Telegram.WebApp.showPopup({
                title: "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶≤‡¶ø‡¶Ç‡¶ï",
                message: message,
                buttons: [{id: 'copy', text: '‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®'}, {id: 'close', text: '‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®'}]
            }, function(buttonId) {
                if (buttonId === 'copy') {
                    navigator.clipboard.writeText(referralLink).then(() => { Telegram.WebApp.showAlert('‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!'); });
                }
            });
        }
        
        function openSupport() { Telegram.WebApp.showAlert(`üìû ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ü‡¶ø‡¶Æ‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®:\n\n‡¶´‡ßã‡¶®: 01913621510\n‡¶á‡¶Æ‡ßá‡¶á‡¶≤: najmulh219653@gmail.com`); }
        function openHistory() { Telegram.WebApp.showAlert("‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®‡ßá‡¶∞ ‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏ ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶∂‡ßÄ‡¶ò‡ßç‡¶∞‡¶á ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá‡•§"); }


        // --- ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶æ ---
        document.addEventListener('DOMContentLoaded', () => {
            if (loadTelegramUser()) {
                fetchUserData();
                const adButton = document.getElementById('ad-button');
                if (adButton) {
                    adButton.addEventListener('click', handleAdButtonClick);
                }
            }
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
        });
    </script>
</body>
</html>

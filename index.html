<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EarnQuick ЁЯОп</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <script src='//libtl.com/sdk.js' data-zone='10070523' data-sdk='show_ad_zone_1'></script>
    <script src='//libtl.com/sdk.js' data-zone='9852420' data-sdk='show_ad_zone_2'></script>
    <script src='//libtl.com/sdk.js' data-zone='10085320' data-sdk='show_ad_zone_3'></script> 

    <style>
        /* ------------------ COMMON STYLES ------------------ */
        :root { --primary-blue: #234d7d; --green-earn: #4CAF50; --orange-withdraw: #FF9800; --secondary-bg: #f5f7f9; --text-color: #333; }
        body { font-family: 'Arial', sans-serif; background-color: var(--secondary-bg); color: var(--text-color); margin: 0; padding: 0; touch-action: manipulation; overflow-x: hidden; width: 100vw; }
        .container { padding: 0; max-width: 600px; margin: auto; background-color: white; min-height: 100vh; }
        .header-container { background: linear-gradient(135deg, #1d2b64, #f8cdda); color: white; padding: 20px 0; text-align: center; border-radius: 0 0 15px 15px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2); margin-bottom: 20px; }
        .marquee-container { background-color: #e3f2fd; color: #1976d2; padding: 5px 10px; margin: 10px 0; border-radius: 5px; font-size: 0.9em; font-weight: bold; overflow: hidden; border: 1px solid #bbdefb; }
        
        #ad-button, #withdraw-button { border: none; padding: 15px 20px; font-size: 16px; font-weight: bold; border-radius: 8px; cursor: pointer; width: 90%; margin: 10px 5%; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }
        #ad-button { background-color: var(--green-earn); color: white; }
        #withdraw-button { background-color: var(--orange-withdraw); color: white; }
        #withdraw-button.disabled-time { background-color: #FF5722; cursor: not-allowed; } 
        
        /* Ad View Popup Styles */
        #ad-view-popup { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000; background: url('https://i.ibb.co/6P93Y1X/bg-image.jpg') no-repeat center center fixed; background-size: cover; backdrop-filter: blur(5px); display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding: 0; box-sizing: border-box; overflow-y: auto; touch-action: manipulation; }
        #cancel-ad-view { position: fixed; top: 10px; left: 50%; transform: translateX(-50%); z-index: 1001; background-color: #f44336; color: white; border: none; padding: 10px 20px; font-size: 14px; font-weight: bold; border-radius: 8px; cursor: pointer; width: 95%; max-width: 400px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); margin: 0; }
        .ad-view-content { background-color: rgba(255, 255, 255, 0.9); padding: 20px; border-radius: 15px; width: 95%; max-width: 400px; box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4); text-align: center; margin-top: 60px; margin-bottom: 20px; }


        /* --- Admin Panel Styles --- */
        .withdrawal-card { border: 1px solid #ccc; padding: 15px; margin-bottom: 10px; border-radius: 8px; background-color: #fff; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .withdrawal-card p { margin: 5px 0; font-size: 14px; }
        .action-buttons button { margin-top: 10px; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .complete-btn { background-color: #4CAF50; color: white; margin-right: 10px; }
        .cancel-btn { background-color: #F44336; color: white; }
    </style>
</head>
<body>
    
    <div class="user-view">
        <div class="header-container">
            <div class="headline-text">ЁЯТ░ EarnQuick Official - рж╕рзНржмрж╛ржЧрждржо! ЁЯТ░</div>
            <div class="referral-info">
                ржЖржкржирж╛рж░ рж░рзЗржлрж╛рж░рзЗрж▓ ржХрж╛ржЙржирзНржЯ: <span id="referral-count-display">0</span> ржЬржи | 
                рж░рзЗржлрж╛рж░рзЗрж▓ ржмрзЛржирж╛рж╕: 250 ржкрзЯрзЗржирзНржЯ
            </div>
            
            <div class="balance-card">
                <p>ржЖржкржирж╛рж░ ржорзЛржЯ ржмрзНржпрж╛рж▓рзЗржирзНрж╕</p>
                <span class="points-display" id="total-points">0</span>
                <p>ржирзНржпрзВржирждржо ржЙрждрзНрждрзЛрж▓ржи: 10000 ржкржпрж╝рзЗржирзНржЯ = 40 ржЯрж╛ржХрж╛</p>
            </div>
        </div>
        
        <div class="ad-container">
            </div>
        
        <div class="marquee-container">
            <marquee behavior="scroll" direction="left" scrollamount="6">
                тЬи **ржмрж┐рж╢рзЗрж╖ ржШрзЛрж╖ржгрж╛:** ржЙржЗржержбрзНрж░ржпрж╝рж╛рж▓ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржЬржорж╛ ржжрзЗржУржпрж╝рж╛рж░ рж╕ржоржпрж╝: **рж╕ржХрж╛рж▓ рзм:рзжрзжржЯрж╛ ржерзЗржХрзЗ рж░рж╛ржд рзо:рзжрзжржЯрж╛** ржкрж░рзНржпржирзНрждред | ЁЯдЭ ржЖржкржирж╛рж░ ржмржирзНржзрзБржХрзЗ рж░рзЗржлрж╛рж░ ржХрж░рзБржи, ржирж┐рж╢рзНржЪрж┐ржд **250 ржкрзЯрзЗржирзНржЯ** ржмрзЛржирж╛рж╕ ржЬрж┐рждрзЗ ржирж┐ржи! | ЁЯУЮ **ржЬрж░рзБрж░рзА ржпрзЛржЧрж╛ржпрзЛржЧ**: 01913621510 | ЁЯПЖ ржЖрж░рзЛ рж╕рж╣ржЬ ржкрзЗржорзЗржирзНржЯрзЗрж░ ржЬржирзНржп ржЖржорж╛ржжрзЗрж░ рж╕рж╛ржерзЗ ржерж╛ржХрзБржиред
            </marquee>
        </div>
        
        <button id="ad-button" disabled onclick="showAdView()">ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрзБржи ржПржмржВ 5 ржкржпрж╝рзЗржирзНржЯ ржпрзЛржЧ ржХрж░рзБржи</button>
        <button id="withdraw-button" onclick="openWithdrawal()">ржЯрж╛ржХрж╛ ржЙрждрзНрждрзЛрж▓ржи ржХрж░рзБржи (Withdraw)</button>
        <p id="status-message">ржбрзЗржЯрж╛ рж▓рзЛржб ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ...</p>

        <div class="menu-grid">
            <div class="menu-btn-container" onclick="openReferral()"><span class="menu-icon">ЁЯФЧ</span><button class="menu-btn">рж░рзЗржлрж╛рж░ ржХрж░рзБржи</button></div>
            <div class="menu-btn-container" onclick="openHistory()"><span class="menu-icon">ЁЯз╛</span><button class="menu-btn">ржкрзЗржорзЗржирзНржЯ рж╣рж┐рж╕рзНржЯрзЛрж░рж┐</button></div>
            <div class="menu-btn-container"><span class="menu-icon">ЁЯУЮ</span><button class="menu-btn" onclick="openSupport()">рж╕рж╛ржкрзЛрж░рзНржЯ</button></div>
        </div>
        
        <div class="ad-container" style="margin-top: 20px;">
            </div>
    </div>
    
    <div id="ad-view-popup" style="display: none;">
        <button id="cancel-ad-view" onclick="hideAdView()">тЧАя╕П ржорзВрж▓ рж╕рзНржХрзНрж░рж┐ржирзЗ ржлрж┐рж░рзЗ ржпрж╛ржи (Cancel)</button>
        
        <div class="ad-view-content">
            <h2>ЁЯОп ржЖржЬржХрзЗрж░ ржЯрж╛рж╕рзНржХ: ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрзБржи</h2>
            <div id="ad-view-status" class="ad-stat-card"></div>
            
            <div class="ad-banner-slot">
                </div>

            <p style="font-size: 0.9em; margin: 15px 0;">ржирж┐ржЪрзЗрж░ ржпрзЗржХрзЛржирзЛ ржПржХржЯрж┐ ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрзБржиред ржкрзНрж░рждрж┐ржЯрж┐ ржмрж┐ржЬрзНржЮрж╛ржкржирзЗ **5** ржкрзЯрзЗржирзНржЯ!</p>
            
            <button class="ad-button-new" id="ad-btn-1" onclick="handleIndividualAdClick(1)">ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрзБржи рзз (рзл ржкрзЯрзЗржирзНржЯ)</button>
            <button class="ad-button-new" id="ad-btn-2" onclick="handleIndividualAdClick(2)">ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрзБржи рзи (рзл ржкрзЯрзЗржирзНржЯ)</button>
            <button class="ad-button-new" id="ad-btn-3" onclick="handleIndividualAdClick(3)">ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрзБржи рзй (рзл ржкрзЯрзЗржирзНржЯ)</button>
            
            <div class="ad-banner-slot" style="margin-top: 15px;">
                </div>
        </div>
    </div>

    <div class="admin-view" id="admin-main-view" style="display:none; padding: 10px;">
        <h2 style="text-align: center; color: #1d2b64;">ЁЯПЖ ржЕрзНржпрж╛ржбржорж┐ржи ржбрзНржпрж╛рж╢ржмрзЛрж░рзНржб</h2>
        <p style="text-align: center; font-weight: bold; color: #f44336;">тЪая╕П ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг: ржЖржкржирж┐ ржЕрзНржпрж╛ржбржорж┐ржи ржорзЛржбрзЗ ржЖржЫрзЗржиред</p>
        
        <button id="refresh-withdrawals" onclick="loadWithdrawals('Pending')" style="background-color: #2196F3; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; width: 100%; margin-bottom: 15px;">ЁЯФД ржкрзЗржирзНржбрж┐ржВ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ рж▓рзЛржб ржХрж░рзБржи</button>
        
        <div style="display: flex; justify-content: space-around; margin-bottom: 20px;">
            <button onclick="loadWithdrawals('Pending')" style="padding: 8px; background-color: #FFC107; border: none; border-radius: 5px;">ржкрзЗржирзНржбрж┐ржВ</button>
            <button onclick="loadWithdrawals('Completed')" style="padding: 8px; background-color: #4CAF50; border: none; border-radius: 5px;">ржХржоржкрзНрж▓рж┐ржЯрзЗржб</button>
            <button onclick="loadWithdrawals('Cancelled')" style="padding: 8px; background-color: #F44336; border: none; border-radius: 5px;">ржХрзНржпрж╛ржирж╕рзЗрж▓ржб</button>
        </div>
        
        <h3 id="withdrawal-list-title" style="color: #607D8B;">ржкрзЗржирзНржбрж┐ржВ ржЙржЗржержбрзНрж░ржпрж╝рж╛рж▓ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ</h3>
        <div id="withdrawal-list-container">
            <p style="text-align: center;" id="admin-status-message">рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ рж▓рзЛржб ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ...</p>
        </div>
        
        <button onclick="toggleAdminView(false)" style="background-color: #795548; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; width: 100%; margin-top: 20px;">ЁЯСд ржЗржЙржЬрж╛рж░ ржнрж┐ржЙрждрзЗ ржлрж┐рж░рзЗ ржпрж╛ржи</button>
    </div>
    
    <script>
        // --- ржХржирж╕рзНржЯрзНржпрж╛ржирзНржЯрж╕ ---
        const SERVER_URL = 'https://smartearnbdbot.onrender.com'; // ржЖржкржирж╛рж░ Render URL
        const BOT_USERNAME = "@EarnQuick_Official_bot";
        const POINTS_PER_TAKA = 250; 
        const POINTS_PER_AD = 5; 
        const MIN_WITHDRAW_POINTS = 10000;
        const WITHDRAW_START_HOUR = 6;  
        const WITHDRAW_END_HOUR = 20; 

        // тШЕтШЕтШЕ ржЖржкржирж╛рж░ ржкрж░рж┐ржмрж░рзНрждрж┐ржд ржПржмржВ ржпрзЛржЧ ржХрж░рж╛ рждржерзНржп тШЕтШЕтШЕ
        const CONTACT_NUMBER = '01913621510'; 
        const CONTACT_EMAIL = 'najmulh219653@gmail.com';
        const ADMIN_ID = '8145444675'; // тШЕтШЕтШЕ ржЖржкржирж╛рж░ ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржЗржЙржЬрж╛рж░ ржЖржЗржбрж┐ тШЕтШЕтШЕ

        let telegramUserId = null;
        let currentPoints = 0;
        
        // --- ржЗржЙржЯрж┐рж▓рж┐ржЯрж┐ ржУ API ржлрж╛ржВрж╢ржи ---
        function loadTelegramUser() {
            try {
                const user = Telegram.WebApp.initDataUnsafe.user;
                if (user && user.id) {
                    telegramUserId = user.id.toString();
                    return true;
                }
                document.getElementById('status-message').innerText = "ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржЕрзНржпрж╛ржкрзЗрж░ ржорж╛ржзрзНржпржорзЗ ржЦрзБрж▓рзБржиред";
                return false;
            } catch (e) {
                document.getElementById('status-message').innerText = "рждрзНрж░рзБржЯрж┐: ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо SDK рж▓рзЛржб рж╣ржпрж╝ржирж┐ред";
                return false;
            }
        }
        
        // --- ржЕрзНржпрж╛ржбржорж┐ржи ржорзЛржб ржЯржЧрж▓ ржХрж░рж╛ ---
        function toggleAdminView(isAdmin) {
            if (isAdmin) {
                document.querySelector('.user-view').style.display = 'none';
                document.getElementById('admin-main-view').style.display = 'block';
                loadWithdrawals('Pending'); 
            } else {
                document.querySelector('.user-view').style.display = 'block';
                document.getElementById('admin-main-view').style.display = 'none';
                if (telegramUserId) fetchUserData(); 
            }
        }

        // --- ржЕрзНржпрж╛ржбржорж┐ржи: ржЙржЗржержбрзНрж░ржпрж╝рж╛рж▓ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ рж▓рзЛржб ржХрж░рж╛ ---
        async function loadWithdrawals(status) {
            document.getElementById('admin-status-message').innerText = `${status} рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ рж▓рзЛржб рж╣ржЪрзНржЫрзЗ...`;
            document.getElementById('withdrawal-list-container').innerHTML = '';
            document.getElementById('withdrawal-list-title').innerText = `${status} ржЙржЗржержбрзНрж░ржпрж╝рж╛рж▓ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ`;

            try {
                const response = await fetch(`${SERVER_URL}/api/get_withdrawals?status=${status}`);
                
                if (response.ok) {
                    const data = await response.json();
                    
                    if (data.length === 0) {
                        document.getElementById('admin-status-message').innerText = `ржПржЗ ржорзБрж╣рзВрж░рзНрждрзЗ ржХрзЛржирзЛ ${status} рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржирзЗржЗред`;
                        return;
                    }

                    document.getElementById('admin-status-message').innerText = `ржорзЛржЯ ${data.length}ржЯрж┐ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржкрж╛ржУржпрж╝рж╛ ржЧрзЗржЫрзЗред`;
                    
                    data.forEach(request => {
                        const card = document.createElement('div');
                        card.className = 'withdrawal-card';
                        card.innerHTML = `
                            <p><strong>Req ID:</strong> ${request.id} | <strong>ржЗржЙржЬрж╛рж░:</strong> ${request.telegram_user_id}</p>
                            <p><strong>ржкржпрж╝рзЗржирзНржЯ:</strong> ${request.points} (рз│ ${(request.points / POINTS_PER_TAKA).toFixed(2)})</p>
                            <p><strong>ржкрзЗржорзЗржирзНржЯ:</strong> ${request.payment_method} - ${request.payment_number}</p>
                            <p><strong>рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕:</strong> <span style="color: ${status === 'Pending' ? 'orange' : status === 'Completed' ? 'green' : 'red'};">${request.status}</span> | <small>(${new Date(request.created_at).toLocaleString()})</small></p>
                            
                            ${request.status === 'Pending' ? `
                            <div class="action-buttons">
                                <button class="complete-btn" onclick="updateWithdrawalStatus(${request.id}, 'Completed', '${request.telegram_user_id}')">тЬЕ ржкрзЗржорзЗржирзНржЯ рж╕ржорзНржкржирзНржи</button>
                                <button class="cancel-btn" onclick="updateWithdrawalStatus(${request.id}, 'Cancelled', '${request.telegram_user_id}')">тЭМ ржмрж╛рждрж┐рж▓ ржХрж░рзБржи</button>
                            </div>
                            ` : ''}
                        `;
                        document.getElementById('withdrawal-list-container').appendChild(card);
                    });

                } else {
                    document.getElementById('admin-status-message').innerText = `ржбрж╛ржЯрж╛ рж▓рзЛржб рждрзНрж░рзБржЯрж┐: ${response.status}. рж╕рж╛рж░рзНржнрж╛рж░ рж▓ржЧ ржжрзЗржЦрзБржиред`;
                }
            } catch (error) {
                console.error('Admin Fetch Error:', error);
                document.getElementById('admin-status-message').innerText = "ржирзЗржЯржУржпрж╝рж╛рж░рзНржХ рждрзНрж░рзБржЯрж┐ред ржбрзЗржЯрж╛ржмрзЗрж╕рзЗрж░ рж╕рж╛ржерзЗ рж╕ржВржпрзЛржЧ ржирзЗржЗред";
            }
        }

        // --- ржЕрзНржпрж╛ржбржорж┐ржи: рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржЖржкржбрзЗржЯ ржХрж░рж╛ ---
        async function updateWithdrawalStatus(requestId, newStatus, userId) {
            if (!confirm(`ржЖржкржирж┐ ржХрж┐ рж╕рждрзНржпрж┐ржЗ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ${requestId} ржХрзЗ "${newStatus}" ржХрж░рждрзЗ ржЪрж╛ржи? ржЗржЙржЬрж╛рж░: ${userId}`)) {
                return;
            }

            try {
                const response = await fetch(`${SERVER_URL}/api/update_withdrawal_status`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        requestId: requestId,
                        status: newStatus
                    })
                });

                if (response.ok) {
                    Telegram.WebApp.showAlert(`рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ${requestId} рж╕ржлрж▓ржнрж╛ржмрзЗ ${newStatus} ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред`);
                    loadWithdrawals('Pending'); 
                } else {
                    Telegram.WebApp.showAlert(`рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржЖржкржбрзЗржЯ ржмрзНржпрж░рзНржеред рждрзНрж░рзБржЯрж┐: ${response.status}`);
                }
            } catch (error) {
                Telegram.WebApp.showAlert("ржирзЗржЯржУржпрж╝рж╛рж░рзНржХ ржмрж╛ рж╕рж╛рж░рзНржнрж╛рж░ рждрзНрж░рзБржЯрж┐ред рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржЖржкржбрзЗржЯ рж╣ржпрж╝ржирж┐ред");
            }
        }
        
        // --- ржЗржЙржЬрж╛рж░ ржбрзЗржЯрж╛ рж▓рзЛржб ржлрж╛ржВрж╢ржи (рж░рзЗржлрж╛рж░рзЗрж▓ ржлрж┐ржХрзНрж╕ржб ржнрж╛рж░рзНрж╕ржи) ---
        async function fetchUserData() {
             document.getElementById('status-message').innerText = "ржбрзЗржЯрж╛ рж▓рзЛржб ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ...";
             
             const urlParams = new URLSearchParams(window.location.search);
             const refererId = urlParams.get('start'); 
             
             try {
                 const response = await fetch(`${SERVER_URL}/api/register_or_check`, {
                     method: 'POST',
                     headers: { 'Content-Type': 'application/json' },
                     body: JSON.stringify({ 
                         userId: telegramUserId,
                         refererId: refererId 
                     })
                 });
                 
                 if (response.ok) {
                     const data = await response.json();
                     currentPoints = data.earned_points;
                     document.getElementById('total-points').innerText = currentPoints.toLocaleString();
                     document.getElementById('referral-count-display').innerText = data.referral_count.toLocaleString();
                     
                     if (data.message && data.message.includes('Referral bonus')) {
                        Telegram.WebApp.showAlert(`тЬЕ рж╕ржлрж▓ рж░рзЗржлрж╛рж░рзЗрж▓! ${data.message.split('points added')[0].split('Referral bonus of ')[1]} ржкрзЯрзЗржирзНржЯ ржЖржкржирж╛рж░ рж░рзЗржлрж╛рж░рж╛рж░ржХрзЗ ржпрзЛржЧ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ!`);
                     }

                     updateUI();
                     document.getElementById('status-message').innerText = "рж╕рзНржмрж╛ржЧрждржо! ржЖржкржирж┐ рж╕ржЪрж▓ ржЖржЫрзЗржиред";
                     document.getElementById('ad-button').disabled = false;
                 } else {
                     document.getElementById('status-message').innerText = `рж╕рж╛рж░рзНржнрж╛рж░ рждрзНрж░рзБржЯрж┐: ${response.status}. рж╕ржВржпрзЛржЧ ржмрж┐ржЪрзНржЫрж┐ржирзНржиред`;
                     Telegram.WebApp.showAlert(`рж╕рж╛рж░рзНржнрж╛рж░ рждрзНрж░рзБржЯрж┐: ${response.status}. рж╕ржВржпрзЛржЧ ржмрж┐ржЪрзНржЫрж┐ржирзНржиред`);
                 }
             } catch (error) {
                 console.error('Fetch Error:', error);
                 document.getElementById('status-message').innerText = "рж╕рж╛рж░рзНржнрж╛рж░рзЗрж░ рж╕рж╛ржерзЗ рж╕ржВржпрзЛржЧ ржмрж┐ржЪрзНржЫрж┐ржирзНржи (Render ржлрзНрж░рж┐ ржЯрж┐рзЯрж╛рж░)ред ржжржпрж╝рж╛ ржХрж░рзЗ рзл-рззрзж рж╕рзЗржХрзЗржирзНржб ржЕржкрзЗржХрзНрж╖рж╛ ржХрж░рзЗ ржЖржмрж╛рж░ ржЕрзНржпрж╛ржкржЯрж┐ ржЪрж╛рж▓рзБ ржХрж░рзБржиред"; 
                 Telegram.WebApp.showAlert("ржирзЗржЯржУржпрж╝рж╛рж░рзНржХ рж╕ржорж╕рзНржпрж╛ ржмрж╛ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рзБ рж╣ржЪрзНржЫрзЗред рзл-рззрзж рж╕рзЗржХрзЗржирзНржб ржкрж░ ржЖржмрж╛рж░ ржЦрзБрж▓рзБржиред");
             }

             // тШЕтШЕтШЕ ржЕрзНржпрж╛ржбржорж┐ржи ржЪрзЗржХ тШЕтШЕтШЕ
             if (telegramUserId.toString() === ADMIN_ID) {
                toggleAdminView(true);
             } else {
                toggleAdminView(false);
             }
        }

        // --- ржкрзНрж▓рзЗрж╕рж╣рзЛрж▓рзНржбрж╛рж░ ржлрж╛ржВрж╢ржи (ржЖржкржирж╛ржХрзЗ ржкрзВрж░рзНржг ржХрж░рждрзЗ рж╣ржмрзЗ) ---
        function updateUI() {
            // UI ржЖржкржбрзЗржЯрзЗрж░ рж▓ржЬрж┐ржХ
        }

        function showAdView() {
            // ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛рж░ ржкржкржЖржк ржжрзЗржЦрж╛ржирзЛрж░ рж▓ржЬрж┐ржХ
            // ...
        }

        function openWithdrawal() {
             // ржЙржЗржержбрзНрж░ржпрж╝рж╛рж▓ рж▓ржЬрж┐ржХ
             // ...
        }

        function openReferral() {
            const referralLink = `https://t.me/${BOT_USERNAME.replace('@', '')}?start=${telegramUserId}`;
            Telegram.WebApp.showPopup({
                title: 'ЁЯдЭ ржЖржкржирж╛рж░ рж░рзЗржлрж╛рж░рзЗрж▓ рж▓рж┐ржВржХ',
                message: `ржЖржкржирж╛рж░ ржмржирзНржзрзБржХрзЗ ржПржЗ рж▓рж┐ржВржХржЯрж┐ рж╢рзЗрзЯрж╛рж░ ржХрж░рзБржиред ржкрзНрж░рждрж┐ рж╕ржлрж▓ рж░рзЗржлрж╛рж░рзЗрж▓рзЗ ржЖржкржирж┐ ржкрж╛ржмрзЗржи ${250} ржкрзЯрзЗржирзНржЯ!`,
                buttons: [
                    { id: 'copy', type: 'default', text: 'ржХржкрж┐ ржХрж░рзБржи' },
                    { id: 'share', type: 'default', text: 'рж╢рзЗрзЯрж╛рж░ ржХрж░рзБржи' },
                    { id: 'close', type: 'cancel', text: 'ржмржирзНржз ржХрж░рзБржи' }
                ]
            }, (buttonId) => {
                if (buttonId === 'copy') {
                    navigator.clipboard.writeText(referralLink).then(() => {
                        Telegram.WebApp.showAlert('рж▓рж┐ржВржХ ржХржкрж┐ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ!');
                    });
                } else if (buttonId === 'share') {
                    Telegram.WebApp.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(referralLink)}&text=${encodeURIComponent('ржЖржорж╛рж░ рж╕рж╛ржерзЗ ржпрзЛржЧ ржжрж┐ржи ржПржмржВ ржкрзНрж░рждрж┐ржжрж┐ржи ржЯрж╛ржХрж╛ ржЖрзЯ ржХрж░рзБржи! ')}`);
                }
            });
        }

        function openHistory() {
             Telegram.WebApp.showAlert('ржкрзЗржорзЗржирзНржЯ рж╣рж┐рж╕рзНржЯрзЛрж░рж┐ ржжрзЗржЦрж╛рж░ ржЕржкрж╢ржиржЯрж┐ ржПржЦржирзЛ ржбрзЗржнрзЗрж▓ржкржорзЗржирзНржЯрзЗ ржЖржЫрзЗред');
        }

        function openSupport() { 
             Telegram.WebApp.showAlert(`ЁЯУЮ рж╕рж╛ржкрзЛрж░рзНржЯ ржЯрж┐ржорзЗрж░ рж╕рж╛ржерзЗ ржпрзЛржЧрж╛ржпрзЛржЧ ржХрж░рзБржи:\n\nржлрзЛржи: ${CONTACT_NUMBER}\nржЗржорзЗржЗрж▓: ${CONTACT_EMAIL}`); 
        }

        // --- ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржи рж╢рзБрж░рзБ ржХрж░рж╛ ---
        document.addEventListener('DOMContentLoaded', () => {
            if (loadTelegramUser()) {
                fetchUserData(); 
            }

            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
        });
        
    </script>
</body>
</html>
